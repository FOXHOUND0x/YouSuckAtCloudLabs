{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Action": "*",
            "Effect": "Allow",
            "Resource": "*",
            "Sid": "DefaultPermit"
        },
        {
            "Action": [
                "aws-portal:ViewPaymentMethods",
                "aws-portal:ViewBudget",
                "aws-portal:ViewBilling",
                "aws-portal:ModifyPaymentMethods",
                "aws-portal:ModifyBilling",
                "aws-portal:ModifyAccount"
            ],
            "Effect": "Deny",
            "Resource": "*",
            "Sid": "DisableBillingModification"
        },
        {
            "Action": [
                "cloudtrail:UpdateTrail",
                "cloudtrail:StopLogging",
                "cloudtrail:StartLogging",
                "cloudtrail:DeleteTrail",
                "cloudtrail:CreateTrail"
            ],
            "Effect": "Deny",
            "Resource": "*",
            "Sid": "DisableCloudTrailModifications"
        },
        {
            "Action": [
                "iam:Update*",
                "iam:Remove*",
                "iam:Detach*",
                "iam:Deactivate*iam",
                "iam:Attach*"
            ],
            "Effect": "Deny",
            "Resource": [
                "arn:aws:iam::702226105286:role/Security-ANAPROD-RW",
                "arn:aws:iam::702226105286:role/SRE-ANAPROD-RW",
                "arn:aws:iam::702226105286:role/ReadOnly-ANAPROD-RO",
                "arn:aws:iam::702226105286:role/Operations-ANAPROD-RW",
                "arn:aws:iam::702226105286:role/Networking-ANAPROD-RW",
                "arn:aws:iam::702226105286:role/Developer-ANAPROD-RW",
                "arn:aws:iam::702226105286:role/Developer-ANAPROD-RO",
                "arn:aws:iam::702226105286:policy/base-user-policies-*"
            ],
            "Sid": "DisableUserRoleModifications"
        },
        {
            "Action": [
                "tag:removeResourceTags",
                "tag:addResourceTags"
            ],
            "Condition": {
                "StringEquals": {
                    "ec2:ResourceTag/application": "*",
                    "ec2:ResourceTag/applicationGroup": "*",
                    "ec2:ResourceTag/contact": "*",
                    "ec2:ResourceTag/department": "*",
                    "ec2:ResourceTag/registry_id": "*",
                    "ec2:ResourceTag/security": "*",
                    "ec2:ResourceTag/service_id": "*"
                }
            },
            "Effect": "Deny",
            "Resource": "*",
            "Sid": "DisableGovernanceTagModifications"
        },
        {
            "Action": [
                "ec2:ReplaceNetworkAclEntry",
                "ec2:ReplaceNetworkAclAssociation",
                "ec2:EnableVpcClassicLink",
                "ec2:DetachVpnGateway",
                "ec2:DeleteVpnGateway",
                "ec2:DeleteVpnConnectionRoute",
                "ec2:DeleteVpnConnection",
                "ec2:DeleteNetworkAclEntry",
                "ec2:DeleteNetworkAcl",
                "ec2:DeleteCustomerGateway",
                "ec2:CreateVpnGateway",
                "ec2:CreateVpnConnectionRoute",
                "ec2:CreateVpnConnection",
                "ec2:CreateNetworkAclEntry",
                "ec2:CreateNetworkAcl",
                "ec2:CreateCustomerGateway",
                "ec2:AttachVpnGateway",
                "directconnect:*"
            ],
            "Effect": "Deny",
            "Resource": "*",
            "Sid": "DisableOperationsNetworking"
        },
        {
            "Condition": {
                "StringEquals": {
                    "ec2:ResourceTag/department": "security"
                }
            },
            "Effect": "Deny",
            "NotAction": "ec2:Describe*",
            "Resource": "*",
            "Sid": "DisableAccessToRestrictedAssets"
        },
        {
            "Action": [
                "waf:*",
                "inspector:*",
                "config:Stop*",
                "config:Start*",
                "config:Put*",
                "config:Delete*",
                "cloudhsm:*"
            ],
            "Effect": "Deny",
            "Resource": "*",
            "Sid": "DisableSecurityModifications"
        }
    ]
}
