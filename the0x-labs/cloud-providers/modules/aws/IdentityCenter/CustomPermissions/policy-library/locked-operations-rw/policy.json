{
  "Version": "2012-10-17",
  "Statement": [
      {
          "Sid": "DefaultPermit",
          "Effect": "Allow",
          "Action": "*",
          "Resource": "*"
      },
      {
          "Sid": "DisableBillingModification",
          "Effect": "Deny",
          "Action": [
              "aws-portal:ViewPaymentMethods",
              "aws-portal:ViewBudget",
              "aws-portal:ViewBilling",
              "aws-portal:ModifyPaymentMethods",
              "aws-portal:ModifyBilling",
              "aws-portal:ModifyAccount"
          ],
          "Resource": "*"
      },
      {
          "Sid": "DisableCloudTrailModifications",
          "Effect": "Deny",
          "Action": [
              "cloudtrail:UpdateTrail",
              "cloudtrail:StopLogging",
              "cloudtrail:StartLogging",
              "cloudtrail:DeleteTrail",
              "cloudtrail:CreateTrail"
          ],
          "Resource": "*"
      },
      {
          "Sid": "DisableUserRoleModifications",
          "Effect": "Deny",
          "Action": [
              "iam:Update*",
              "iam:Remove*",
              "iam:Detach*",
              "iam:Deactivate*iam",
              "iam:Attach*"
          ],
          "Resource": [
              "arn:aws:iam::280420224304:role/Security-ECOMPROD-RW",
              "arn:aws:iam::280420224304:role/SRE-ECOMPROD-RW",
              "arn:aws:iam::280420224304:role/ReadOnly-ECOMPROD-RO",
              "arn:aws:iam::280420224304:role/Operations-ECOMPROD-RW",
              "arn:aws:iam::280420224304:role/Networking-ECOMPROD-RW",
              "arn:aws:iam::280420224304:role/Developer-ECOMPROD-RW",
              "arn:aws:iam::280420224304:role/Developer-ECOMPROD-RO",
              "arn:aws:iam::280420224304:policy/base-user-policies-*"
          ]
      },
      {
          "Sid": "DisableGovernanceTagModifications",
          "Effect": "Deny",
          "Action": [
              "tag:removeResourceTags",
              "tag:addResourceTags"
          ],
          "Resource": "*",
          "Condition": {
              "StringEquals": {
                  "ec2:ResourceTag/application": "*",
                  "ec2:ResourceTag/applicationGroup": "*",
                  "ec2:ResourceTag/contact": "*",
                  "ec2:ResourceTag/department": "*",
                  "ec2:ResourceTag/registry_id": "*",
                  "ec2:ResourceTag/security": "*",
                  "ec2:ResourceTag/service_id": "*"
              }
          }
      },
      {
          "Sid": "DisableOperationsNetworking",
          "Effect": "Deny",
          "Action": [
              "ec2:ReplaceNetworkAclEntry",
              "ec2:ReplaceNetworkAclAssociation",
              "ec2:EnableVpcClassicLink",
              "ec2:DetachVpnGateway",
              "ec2:DeleteVpnGateway",
              "ec2:DeleteVpnConnectionRoute",
              "ec2:DeleteVpnConnection",
              "ec2:DeleteNetworkAclEntry",
              "ec2:DeleteNetworkAcl",
              "ec2:DeleteCustomerGateway",
              "ec2:CreateVpnGateway",
              "ec2:CreateVpnConnectionRoute",
              "ec2:CreateVpnConnection",
              "ec2:CreateNetworkAclEntry",
              "ec2:CreateNetworkAcl",
              "ec2:CreateCustomerGateway",
              "ec2:AttachVpnGateway",
              "directconnect:*"
          ],
          "Resource": "*"
      },
      {
          "Sid": "DisableAccessToRestrictedAssets",
          "Effect": "Deny",
          "NotAction": "ec2:Describe*",
          "Resource": "*",
          "Condition": {
              "StringEquals": {
                  "ec2:ResourceTag/department": "security"
              }
          }
      },
      {
          "Sid": "DisableSecurityModifications",
          "Effect": "Deny",
          "Action": [
              "waf:*",
              "inspector:*",
              "config:Stop*",
              "config:Start*",
              "config:Put*",
              "config:Delete*",
              "cloudhsm:*"
          ],
          "Resource": "*"
      }
  ]
}
